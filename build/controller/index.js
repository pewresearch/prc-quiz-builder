(()=>{"use strict";var e,t={848:(e,t,r)=>{const o=window.wp.blocks;function i(e){var t,r,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=i(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}const a=function(){for(var e,t,r=0,o="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=i(e))&&(o&&(o+=" "),o+=t);return o},s=window.wp.i18n,n=window.wp.element,l=window.wp.blockEditor,c=window.wp.data,p=window.prcCopilot,u=window.wp.components,d=window.wp.apiFetch;var g=r.n(d);const h=window.prcQuizSharedComponents,m=(window.wp.notices,window.ReactJSXRuntime);const b=window.prcIcons;function y({variant:e="quiz"}){return"freeform"===e?(0,m.jsx)(b.Icon,{icon:"block-question",library:"solid"}):(0,m.jsx)(b.Icon,{icon:"block-question",library:"light"})}const f=function({attributes:e,setAttributes:t,clientId:r}){const{groupsEnabled:o,demoBreakLabels:i,threshold:a,displayType:d,allowSubmissions:b}=e,{postId:f}=(0,c.useSelect)((e=>({postId:e("core/editor").getCurrentPostId()}))),[w,v]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{(0,p.addToCopilotToolbar)({title:"Generate Quiz",icon:y,toolType:"request",tool:"generate-knowledge-quiz",onRequest:async(e,t,r,o,i)=>{try{const{data:r,metadata:a}=await async function(e="",t=""){try{const r=`${e}${t?`\n\nAdditional instructions: ${t}`:""}`,o=await(0,p.processToolRequest)(r,"generate-knowledge-quiz");if(!o||!o.candidates||0===o.candidates.length)throw new Error("No quiz content generated",o);return o.candidates[0]}catch(e){throw console.error("Error generating quiz:",e),e}}(e,t);if(console.log("...data...",r),!r)return void i.createErrorNotice("No data could be generated for your request.");r.length>1&&i.createSuccessNotice("Quiz generated. Please review results."),console.log("data...",o,r,a)}catch(e){i.createErrorNotice(e?.message||String(e))}}})}),[r]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.InspectorAdvancedControls,{children:(0,m.jsx)(u.BaseControl,{label:"Purge Quiz Archetypes",help:"Purge the quiz archetypes. This will remove all the archetypes for the quiz.",children:(0,m.jsx)(u.Button,{variant:"primary",isDestructive:!0,isBusy:w,text:w?"Purging...":"Purge Archetypes",onClick:()=>{console.log("purgeArchetypes",f),v(!0),g()({path:`/prc-api/v3/quiz/purge-archetypes?quizId=${f}`,method:"POST"}).then((e=>{console.log("response",e),v(!1)})).catch((e=>{console.error("error",e),v(!1)}))}})})}),(0,m.jsxs)(l.InspectorControls,{children:[(0,m.jsxs)(u.PanelBody,{title:(0,s.__)("Quiz Settings"),children:[(0,m.jsx)(u.SelectControl,{label:"Display Type",help:"Select the display type for the quiz. Paged will display the quiz in pages, scrollable will display the quiz as a single page with a scrollable container.",options:[{label:"Paged",value:"paged"},{label:"Scrollable",value:"scrollable"}],value:d,onChange:e=>{t({displayType:e})}}),(0,m.jsx)(u.ToggleControl,{label:"Allow Submissions",help:"Allow users to submit the quiz. If disabled, users will not be able to submit the quiz and will only be able to view the results. This means the results will not be shareable with the public.",checked:b,onChange:()=>{t({allowSubmissions:!b})}}),(0,m.jsx)(u.__experimentalNumberControl,{label:"Answer Threshold",help:"Number of selected answers needed to complete the quiz.",value:a,isShiftStepEnabled:!0,isDragEnabled:!0,onChange:e=>{t({threshold:Math.round(parseFloat(e)||0)})},min:1,max:15,type:"number"})]}),(0,m.jsx)(u.PanelBody,{title:(0,s.__)("Community Groups"),initialOpen:!1,children:(0,m.jsxs)(u.BaseControl,{id:"community-groups",label:(0,s.__)("Community Groups"),children:[(0,m.jsx)(u.ToggleControl,{label:o?"Enabled":"Disabled",checked:o,onChange:()=>{t({groupsEnabled:!o})}}),!0===o&&(0,m.jsx)(u.TextControl,{label:"Mailchimp List ID",help:"Enter a Mailchimp list id that group owners will be subscribed to for future communication about this quiz.",value:e.mailchimpListId,onChange:e=>{t({mailchimpListId:e})}})]})}),(0,m.jsx)(u.PanelBody,{title:(0,s.__)("Demographic Breakdown"),initialOpen:!1,children:(0,m.jsx)(h.JSONSortableList,{label:(0,s.__)("Demographic Breakdown Labels","prc-quiz"),help:(0,s.__)("Set the labels/categories for demographic breakdowns. When you add values here you will be prompted per question block to add values to each category. These will appear in the results table block.","prc-quiz"),values:void 0===i?[]:JSON.parse(i),labels:"Demographic Break",onChange:e=>{t({demoBreakLabels:JSON.stringify(e)})}})})]})]})},w=[["prc-quiz/pages",{},[["prc-quiz/page",{title:(0,s.__)("Introduction","prc-quiz")},[["core/post-title",{}],["core/paragraph",{placeholder:"Introduction page content here..."}]]],["prc-quiz/page",{title:(0,s.__)("Question 1 of X","prc-quiz")}]]],["prc-quiz/results",{},[["prc-quiz/result-score"]]]],v=[{name:"quiz",isDefault:!0,title:(0,s.__)("Knowledge Quiz"),description:(0,s.__)("A knowledge quiz includes a series of questions with single, multiple-choice, or thermometer-type answers. Users receive scores based on their responses, which are either correct or incorrect. Correct answers contribute points to the total score at the end of the quiz, incorrect answers do not."),attributes:{type:"quiz"},scope:["inserter","transform"],isActive:e=>"quiz"===e.type},{name:"freeform",title:(0,s.__)("Freeform Quiz"),description:(0,s.__)("A freeform quiz presents users with a series of questions, including single-choice, multiple-choice, and thermometer-type answers. Users responses are scored based on point values rather than correct or incorrect answers. The score can generate various result configurations or custom result pages with tailored score calculations, such as in a political freeform quiz."),icon:(0,m.jsx)(y,{variant:"freeform"}),attributes:{type:"freeform"},scope:["inserter","transform"],isActive:e=>"freeform"===e.type}];const z=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-quiz/controller","version":"4.0.0","title":"Quiz Controller","description":"This block controls all aspects of a quiz.","category":"quiz","keywords":["quiz","typology"],"allowedBlocks":["prc-quiz/pages","prc-quiz/results","prc-quiz/group-results"],"attributes":{"type":{"type":"string","enum":["quiz","typology","freeform"],"default":"quiz"},"displayType":{"type":"string","enum":["paged","scrollable"],"default":"paged"},"allowSubmissions":{"type":"boolean","default":true},"groupsEnabled":{"type":"boolean","default":false},"mailchimpListId":{"type":"string"},"demoBreakLabels":{"type":"string"},"threshold":{"type":"number","default":4}},"providesContext":{"prc-quiz/type":"type","prc-quiz/display-type":"displayType","prc-quiz/demo-break-labels":"demoBreakLabels","prc-quiz/threshold":"threshold","prc-quiz/groupsEnabled":"groupsEnabled","prc-quiz/allowSubmissions":"allowSubmissions"},"usesContext":["prc-quiz/isEmbedded"],"supports":{"anchor":true,"html":false,"interactivity":true,"color":{"background":true,"text":true,"link":true},"spacing":{"blockGap":true,"margin":["top","bottom"],"padding":true,"__experimentalDefaultControls":{"padding":true}},"typography":{"fontSize":true,"__experimentalFontFamily":true,"__experimentalDefaultControls":{"fontSize":true,"__experimentalFontFamily":true}}},"textdomain":"controller","editorScript":["ais-ai","file:./index.js"],"editorStyle":"file:./index.css","style":"file:./style-index.css","viewStyle":"file:./view/style-index.css","viewScriptModule":"file:./view.js"}'),{name:q}=z,k={icon:y,edit:function({attributes:e,setAttributes:t,className:r,context:o,clientId:i,isSelected:s}){const{allowedBlocks:n,displayType:p}=e,u=(0,l.useBlockProps)({className:a(r,{"is-scrollable":"scrollable"===p,"is-paged":"paged"===p})}),d=(0,l.useInnerBlocksProps)(u,{allowedBlocks:n,orientation:"vertical",template:w}),g=(0,c.useSelect)((e=>{const{getClientIdsOfDescendants:t,getBlock:r}=e("core/block-editor");return t(i).map((e=>({block:r(e),clientId:e}))).filter((({block:e})=>"prc-quiz/page"===e?.name||"prc-quiz/question"===e?.name||"prc-quiz/answer"===e?.name)).reduce(((e,{block:t,clientId:r})=>{const o=t.attributes.uuid;return o&&(e[o]=r),e}),{})}),[i]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(f,{attributes:e,setAttributes:t,clientId:i}),(0,m.jsx)("div",{...d,children:(0,m.jsx)(l.BlockContextProvider,{value:{"prc-quiz/uuids":g},children:(0,m.jsx)("div",{...d})})})]})},save:function({attributes:e}){const t=l.useBlockProps.save(),r=l.useInnerBlocksProps.save(t);return(0,m.jsx)("div",{...r})},variations:v};(0,o.registerBlockType)(q,{...z,...k}),[{label:"Create Group",description:"Create a group quiz",namespace:"prc-quiz/controller",action:"createGroup",method:"api",template:[["prc-block/form-input-text",{type:"text",label:"Group Name",placeholder:"Enter your group name",metadata:{name:"groupName"}}],["prc-block/form-submit",{label:"Create"}],["prc-block/form-message",{},[["core/paragraph",{content:"Group Created!"}]]]]}].forEach((e=>{(0,c.dispatch)("prc-block-library/forms").registerForm(e)})),(0,o.registerBlockVariation)("prc-block/dialog",{icon:function(){return(0,m.jsx)(b.Icon,{icon:"users-viewfinder"})},title:"Group Quiz Form",description:"Create a group quiz form",attributes:{},innerBlocks:[["prc-block/dialog-trigger",{},[["core/button",{},[]]]],["prc-block/dialog-element",{backdropColor:"ui-gray-dark",borderColor:"ui-gray-very-dark",backgroundColor:"white",fontFamily:"sans-serif",style:{spacing:{padding:{top:"var:preset|spacing|30",bottom:"var:preset|spacing|30",left:"var:preset|spacing|30",right:"var:preset|spacing|30"}},shadow:"var:preset|shadow|deep",border:{radius:"5px",width:"1px"}}},[["core/group",{style:{spacing:{blockGap:"var:preset|spacing|30",padding:{top:"var:preset|spacing|30",bottom:"var:preset|spacing|30"},margin:{bottom:"var:preset|spacing|50"}}},layout:{type:"flex",orientation:"vertical"}},[["core/paragraph",{style:{typography:{lineHeight:"1"}}},[]],["core/post-title",{style:{spacing:{padding:{top:"0",bottom:"0",left:"0",right:"0"},margin:{top:"0",bottom:"0"}},typography:{lineHeight:"1"}},fontSize:"medium",fontFamily:"sans-serif"},[]]]],["prc-user-accounts/content-gate",{},[["core/group",{layout:{type:"default"}},[["prc-block/form",{namespace:"prc-quiz/controller",action:"createGroup",layout:{type:"constrained",orientation:"vertical",verticalAlignment:"center",allowOrientation:!0,contentSize:"420px",justifyContent:"left"},interactiveNamespace:"prc-quiz/controller"},[["prc-block/form-input-text",{required:!0,layout:{type:"flex",orientation:"horizontal",verticalAlignment:"center",allowOrientation:!0},metadata:{name:"groupName"}},[]],["prc-block/form-submit",{},[["core/button",{tagName:"button",type:"submit"},[]],["prc-block/form-captcha",{},[]]]],["prc-block/form-message",{},[["core/paragraph",{},[]]]]]]]]]]]]]})}},r={};function o(e){var i=r[e];if(void 0!==i)return i.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,r,i,a)=>{if(!r){var s=1/0;for(p=0;p<e.length;p++){for(var[r,i,a]=e[p],n=!0,l=0;l<r.length;l++)(!1&a||s>=a)&&Object.keys(o.O).every((e=>o.O[e](r[l])))?r.splice(l--,1):(n=!1,a<s&&(s=a));if(n){e.splice(p--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var p=e.length;p>0&&e[p-1][2]>a;p--)e[p]=e[p-1];e[p]=[r,i,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var i,a,[s,n,l]=r,c=0;if(s.some((t=>0!==e[t]))){for(i in n)o.o(n,i)&&(o.m[i]=n[i]);if(l)var p=l(o)}for(t&&t(r);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(p)},r=globalThis.webpackChunk_prc_quiz_builder=globalThis.webpackChunk_prc_quiz_builder||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[350],(()=>o(848)));i=o.O(i)})();
//# sourceMappingURL=index.js.map