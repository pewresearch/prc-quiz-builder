(()=>{"use strict";var e,t={383:()=>{const e=window.wp.blocks,t=window.wp.i18n,r=window.wp.element,o=window.wp.blockEditor,i=window.wp.data,s=window.wp.components,a=window.ReactJSXRuntime;function l({attributes:e,setAttributes:r,colors:i}){const{message:l,width:n,height:c,barLabelPosition:h,barLabelCutoff:d,barWidth:u,yAxisDomain:b,xAxisLabel:g}=e,{barColor:p,setBarColor:x,isHighlightedColor:m,setIsHighlightedColor:f}=i;return(0,a.jsxs)(o.InspectorControls,{children:[(0,a.jsxs)(s.PanelBody,{title:(0,t.__)("Histogram Settings"),children:[(0,a.jsx)(s.TextareaControl,{label:"Score Message",help:(0,t.__)("You can add the score to your share message by using %s"),value:l,onChange:e=>{r({message:e})}}),(0,a.jsx)(s.RangeControl,{label:"Histogram Width",help:(0,t.__)("Width defaults to 640px"),value:n,onChange:e=>{r({width:e})},min:500,max:800}),(0,a.jsx)(s.RangeControl,{label:"Histogram Height",help:(0,t.__)("Height defaults to 300px"),value:c,onChange:e=>{r({height:e})},min:150,max:600}),(0,a.jsx)(s.RangeControl,{label:"Bar Width",help:(0,t.__)("Width defaults to 24px"),value:u,onChange:e=>{r({barWidth:e})},min:10,max:40}),(0,a.jsx)(s.TextControl,{label:"X Axis Label",value:g,onChange:e=>{r({xAxisLabel:e})}})]}),(0,a.jsx)(o.PanelColorSettings,{__experimentalHasMultipleOrigins:!0,__experimentalIsRenderedInSidebar:!0,title:(0,t.__)("Colors"),disableCustomColors:!0,colorSettings:[{value:p.color,onChange:x,label:(0,t.__)("Bar")},{value:m.color,onChange:f,label:(0,t.__)("Highlight")}]})]})}function n({attributes:e,barColor:t,isHighlightedColor:r}){const{histogramData:o,width:i,height:s,barLabelCutoff:l=0,barWidth:n,xAxisLabel:c}=e;let h=[];try{const e="string"==typeof o?JSON.parse(o||"[]"):o;h=Array.isArray(e)?e.map((e=>({x:Number(e.x),y:Number(e.y)}))).filter((e=>Number.isFinite(e.x)&&Number.isFinite(e.y))):[]}catch(e){h=[]}const d=Math.max(1,...h.map((e=>e.y))),u=h.length?h.reduce(((e,t)=>t.y>e.y?t:e),h[0]).x:null;return(0,a.jsxs)("div",{className:"histogram-preview",style:{width:i},children:[(0,a.jsx)("div",{className:"bars",style:{height:s},children:h.map((e=>{const o=e.y/d*100,i=null!==u&&e.x===u,s=e.y<1?"<1%":`${Math.round(e.y)}%`,c=i?r?.color||"#e0b500":t?.color||"#000",h={};return e.y<=l&&(h.top="-22px",h.color="#000"),(0,a.jsxs)("div",{className:"bar"+(i?" is-highlighted":""),style:{height:`${o}%`,backgroundColor:c,width:`${n}px`},children:[(0,a.jsx)("span",{className:"bar__label",style:h,children:s}),(0,a.jsx)("span",{className:"bar__x",children:String(e.x)})]},e.x)}))}),(0,a.jsx)("div",{className:"x-axis-label",children:c})]})}const c=[["prc-block/table",{className:"histogram-data-table test-class",head:[{cells:[{content:"# of Correct Answers",tag:"th"},{content:"% of Public",tag:"th"}]}],body:[{cells:[{content:"0",tag:"td"},{content:"10",tag:"td"}]},{cells:[{content:"1",tag:"td"},{content:"20",tag:"td"}]},{cells:[{content:"2",tag:"td"},{content:"30",tag:"td"}]},{cells:[{content:"3",tag:"td"},{content:"20",tag:"td"}]}]}]],h=(0,o.withColors)({barColor:"color"},{isHighlightedColor:"color"})((function({attributes:e,setAttributes:t,context:s,clientId:h,isSelected:d,barColor:u,setBarColor:b,isHighlightedColor:g,setIsHighlightedColor:p}){const{message:x,histogramData:m,width:f,height:y,barWidth:C,barLabelPosition:w,barLabelCutoff:v,yAxisDomain:j,xAxisLabel:_}=e,k=(0,o.useBlockProps)(),H=(0,o.useInnerBlocksProps)(k,{template:c,templateLock:"all",allowedBlocks:["prc-block/table"]}),S=(0,i.useSelect)((e=>e("core/block-editor").getBlocks(h).find((e=>"prc-block/table"===e.name))),[h]);return(0,r.useEffect)((()=>{if(S){const e=S.attributes.body.map((e=>({x:e.cells[0].content,y:e.cells[1].content})));m!==JSON.stringify(e)&&t({histogramData:JSON.stringify(e)})}}),[S]),(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)(l,{attributes:e,setAttributes:t,colors:{barColor:u,setBarColor:b,isHighlightedColor:g,setIsHighlightedColor:p}}),(0,a.jsxs)("div",{...k,children:[(0,a.jsx)("p",{children:x}),(0,a.jsx)("div",{...H}),(0,a.jsxs)("div",{id:"score",children:[(0,a.jsxs)("h2",{children:["You answered ",(0,a.jsx)("span",{children:"X"})," questions correctly"]}),(0,a.jsx)("h3",{children:"You scored better than x% of the public, below y% of the public and the same as z% of the public."})]}),(0,a.jsx)("div",{id:"bar-chart",children:(0,a.jsx)(n,{attributes:e,barColor:u,isHighlightedColor:g})})]})]})})),d=window.prcIcons,u=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-quiz/result-histogram","version":"4.0","title":"Result Histogram","category":"quiz","description":"Histogram representing distribution of scores.","attributes":{"message":{"type":"string"},"histogramData":{"type":"string"},"width":{"type":"number","default":640},"height":{"type":"number","default":300},"barWidth":{"type":"number","default":30},"barLabelPosition":{"type":"number","default":0},"barLabelCutoff":{"type":"number","default":0},"barColor":{"type":"string","default":"oatmeal"},"isHighlightedColor":{"type":"string","default":"mustard"},"yAxisDomain":{"type":"number","default":50},"xAxisLabel":{"type":"string"}},"supports":{"anchor":true,"html":false,"interactivity":true,"spacing":{"blockGap":true,"margin":["top","bottom"],"padding":true},"typography":{"fontSize":true,"__experimentalFontFamily":true}},"ancestor":["prc-quiz/results"],"usesContext":["prc-quiz/id","prc-quiz/type"],"textdomain":"result-histogram","editorScript":"file:./index.js","editorStyle":"file:./index.css","viewScriptModule":"file:./view.js","style":"file:./style-index.css"}'),{name:b}=u,g={icon:function(){return(0,a.jsx)(d.Icon,{icon:"chart-column"})},edit:h,save:function({attributes:e}){return(0,a.jsx)(o.InnerBlocks.Content,{})}};(0,e.registerBlockType)(b,{...u,...g})}},r={};function o(e){var i=r[e];if(void 0!==i)return i.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,o),s.exports}o.m=t,e=[],o.O=(t,r,i,s)=>{if(!r){var a=1/0;for(h=0;h<e.length;h++){for(var[r,i,s]=e[h],l=!0,n=0;n<r.length;n++)(!1&s||a>=s)&&Object.keys(o.O).every((e=>o.O[e](r[n])))?r.splice(n--,1):(l=!1,s<a&&(a=s));if(l){e.splice(h--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var h=e.length;h>0&&e[h-1][2]>s;h--)e[h]=e[h-1];e[h]=[r,i,s]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={96:0,744:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var i,s,[a,l,n]=r,c=0;if(a.some((t=>0!==e[t]))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(n)var h=n(o)}for(t&&t(r);c<a.length;c++)s=a[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(h)},r=globalThis.webpackChunk_prc_quiz_builder=globalThis.webpackChunk_prc_quiz_builder||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[744],(()=>o(383)));i=o.O(i)})();
//# sourceMappingURL=index.js.map