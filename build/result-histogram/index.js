(()=>{"use strict";var e,t={942:()=>{const e=window.wp.blocks,t=window.wp.i18n,r=window.wp.element,o=window.wp.blockEditor,s=window.wp.data,i=window.wp.components,l=window.ReactJSXRuntime;function a({attributes:e,setAttributes:r,colors:s}){const{message:a,height:n,barLabelPosition:c,barLabelCutoff:d,barWidth:h,yAxisDomain:u,xAxisLabel:g}=e,{barColor:b,setBarColor:p,isHighlightedColor:x,setIsHighlightedColor:m}=s;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.InspectorControls,{children:(0,l.jsxs)(i.PanelBody,{title:(0,t.__)("Histogram Settings"),children:[(0,l.jsx)(i.TextareaControl,{label:"Score Message",help:(0,t.__)("You can add the score to your share message by using %s"),value:a,onChange:e=>{r({message:e})}}),(0,l.jsx)(i.RangeControl,{label:"Histogram Height",help:(0,t.__)("Height defaults to 300px"),value:n,onChange:e=>{r({height:e})},min:150,max:600}),(0,l.jsx)(i.RangeControl,{label:"Bar Width",help:(0,t.__)("Width defaults to 24px"),value:h,onChange:e=>{r({barWidth:e})},min:10,max:40}),(0,l.jsx)(i.TextControl,{label:"X Axis Label",value:g,onChange:e=>{r({xAxisLabel:e})}})]})}),(0,l.jsx)(o.InspectorControls,{group:"colors",children:(0,l.jsx)(o.PanelColorSettings,{__experimentalHasMultipleOrigins:!0,__experimentalIsRenderedInSidebar:!0,title:(0,t.__)("Colors"),disableCustomColors:!0,colorSettings:[{value:b.color,onChange:p,label:(0,t.__)("Bar")},{value:x.color,onChange:m,label:(0,t.__)("Highlight")}]})})]})}function n({attributes:e,barColor:t,isHighlightedColor:r}){const{histogramData:o,height:s,barLabelCutoff:i=0,barWidth:a,xAxisLabel:n}=e;let c=[];try{const e="string"==typeof o?JSON.parse(o||"[]"):o;c=Array.isArray(e)?e.map(e=>({x:Number(e.x),y:Number(e.y)})).filter(e=>Number.isFinite(e.x)&&Number.isFinite(e.y)):[]}catch(e){c=[]}const d=Math.max(1,...c.map(e=>e.y)),h=c.length?c.reduce((e,t)=>t.y>e.y?t:e,c[0]).x:null;return(0,l.jsxs)("div",{className:"histogram-preview",children:[(0,l.jsx)("div",{className:"bars",style:{height:s},children:c.map(e=>{const o=e.y/d*100,s=null!==h&&e.x===h,n=e.y<1?"<1%":`${Math.round(e.y)}%`,c=s?r?.color||"#e0b500":t?.color||"#000",u={};return e.y<=i&&(u.top="-22px",u.color="#000"),(0,l.jsxs)("div",{className:"bar"+(s?" is-highlighted":""),style:{height:`${o}%`,backgroundColor:c,width:`${a}px`},children:[(0,l.jsx)("span",{className:"bar__label",style:u,children:n}),(0,l.jsx)("span",{className:"bar__x",children:String(e.x)})]},e.x)})}),(0,l.jsx)("div",{className:"x-axis-label",children:n})]})}const c=[["prc-block/table",{className:"histogram-data-table test-class",head:[{cells:[{content:"# of Correct Answers",tag:"th"},{content:"% of Public",tag:"th"}]}],body:[{cells:[{content:"0",tag:"td"},{content:"10",tag:"td"}]},{cells:[{content:"1",tag:"td"},{content:"20",tag:"td"}]},{cells:[{content:"2",tag:"td"},{content:"30",tag:"td"}]},{cells:[{content:"3",tag:"td"},{content:"20",tag:"td"}]}]}]],d=(0,o.withColors)({barColor:"color"},{isHighlightedColor:"color"})(function({attributes:e,setAttributes:t,context:i,clientId:d,isSelected:h,barColor:u,setBarColor:g,isHighlightedColor:b,setIsHighlightedColor:p}){const{message:x,histogramData:m}=e,y=(0,o.useBlockProps)(),f=(0,o.useInnerBlocksProps)(y,{template:c,templateLock:"all",allowedBlocks:["prc-block/table"]}),C=(0,s.useSelect)(e=>e("core/block-editor").getBlocks(d).find(e=>"prc-block/table"===e.name),[d]);return(0,r.useEffect)(()=>{if(C){const e=C.attributes.body.map(e=>({x:e.cells[0].content,y:e.cells[1].content}));m!==JSON.stringify(e)&&t({histogramData:JSON.stringify(e)})}},[C]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a,{attributes:e,setAttributes:t,colors:{barColor:u,setBarColor:g,isHighlightedColor:b,setIsHighlightedColor:p}}),(0,l.jsxs)("div",{...y,children:[(0,l.jsx)("p",{children:x}),(0,l.jsx)("div",{...f}),(0,l.jsxs)("div",{id:"score",children:[(0,l.jsxs)("h2",{children:["You answered ",(0,l.jsx)("span",{children:"X"})," questions correctly"]}),(0,l.jsx)("h3",{children:"You scored better than x% of the public, below y% of the public and the same as z% of the public."})]}),(0,l.jsx)("div",{id:"bar-chart",children:(0,l.jsx)(n,{attributes:e,barColor:u,isHighlightedColor:b})})]})]})}),h=window.prcIcons,u=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-quiz/result-histogram","version":"4.0","title":"Result Histogram","category":"quiz","description":"Histogram representing distribution of scores.","attributes":{"message":{"type":"string"},"histogramData":{"type":"string"},"height":{"type":"number","default":300},"barWidth":{"type":"number","default":30},"barLabelPosition":{"type":"number","default":0},"barLabelCutoff":{"type":"number","default":0},"barColor":{"type":"string","default":"oatmeal"},"isHighlightedColor":{"type":"string","default":"mustard"},"yAxisDomain":{"type":"number","default":50},"xAxisLabel":{"type":"string"}},"supports":{"anchor":true,"html":false,"interactivity":true,"align":true,"alignWide":true,"spacing":{"blockGap":true,"margin":["top","bottom"],"padding":true},"typography":{"fontSize":true,"__experimentalFontFamily":true}},"ancestor":["prc-quiz/results"],"usesContext":["prc-quiz/id","prc-quiz/type"],"textdomain":"result-histogram","editorScript":"file:./index.js","editorStyle":"file:./index.css","viewScriptModule":"file:./view.js","style":"file:./style-index.css"}'),{name:g}=u,b={icon:function(){return(0,l.jsx)(h.Icon,{icon:"chart-column"})},edit:d,save:function({attributes:e}){return(0,l.jsx)(o.InnerBlocks.Content,{})}};(0,e.registerBlockType)(g,{...u,...b})}},r={};function o(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,r,s,i)=>{if(!r){var l=1/0;for(d=0;d<e.length;d++){for(var[r,s,i]=e[d],a=!0,n=0;n<r.length;n++)(!1&i||l>=i)&&Object.keys(o.O).every(e=>o.O[e](r[n]))?r.splice(n--,1):(a=!1,i<l&&(l=i));if(a){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[r,s,i]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={96:0,744:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var s,i,[l,a,n]=r,c=0;if(l.some(t=>0!==e[t])){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);if(n)var d=n(o)}for(t&&t(r);c<l.length;c++)i=l[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},r=globalThis.webpackChunk_prc_quiz_builder=globalThis.webpackChunk_prc_quiz_builder||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=o.O(void 0,[744],()=>o(942));s=o.O(s)})();
//# sourceMappingURL=index.js.map