(()=>{"use strict";var e={n:s=>{var t=s&&s.__esModule?()=>s.default:()=>s;return e.d(t,{a:t}),t},d:(s,t)=>{for(var n in t)e.o(t,n)&&!e.o(s,n)&&Object.defineProperty(s,n,{enumerable:!0,get:t[n]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.primitives,t=window.ReactJSXRuntime,n=(0,t.jsx)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(s.Path,{fillRule:"evenodd",d:"M11.25 5h1.5v15h-1.5V5zM6 10h1.5v10H6V10zm12 4h-1.5v6H18v-6z",clipRule:"evenodd"})}),a=window.wp.element,r=(0,a.forwardRef)(({icon:e,size:s=24,...t},n)=>(0,a.cloneElement)(e,{width:s,height:s,...t,ref:n})),i=window.wp.i18n,l=window.React,o=window.wp.plugins,c=window.wp.editor,d=window.wp.data,u=window.wp.apiFetch;var h=e.n(u);const p=window.wp.components;function m({values:e=[30,60,90,60,100,50,45,20,70,80,90,40]}){const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=s=>{const t=Math.max(...e),n=t>0?s/t*100:0;return 0===s?"none":n<=25?"low":n<=50?"medium":n<=75?"high":"very-high"};return(0,t.jsx)("div",{className:"calendar-chart",children:e.map((e,a)=>(0,t.jsx)("div",{className:"calendar-chart-item","data-month":s[a],"data-heat":n(e),children:(0,t.jsx)("span",{className:"value",children:e})},a))})}function w({first24Hours:e,firstWeek:s,total:n}){return(0,t.jsxs)("div",{className:"analytics-summary",children:[(0,t.jsxs)("div",{className:"summary-stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"First 24 Hours"}),(0,t.jsx)("span",{className:"stat-value",children:e||0})]}),(0,t.jsxs)("div",{className:"summary-stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"First Week"}),(0,t.jsx)("span",{className:"stat-value",children:s||0})]}),(0,t.jsxs)("div",{className:"summary-stat",children:[(0,t.jsx)("span",{className:"stat-label",children:"Total"}),(0,t.jsx)("span",{className:"stat-value",children:n||0})]})]})}function j({postId:e}){const s=function(e){const[s,t]=(0,a.useState)(null);return(0,a.useEffect)(()=>{e&&h()({path:`/wp/v2/quiz/${e}?_fields=_submissions`,method:"GET"}).then(e=>{t({success:!0,...e._submissions})}).catch(e=>{console.error({error:e})})},[e]),s}(e),n=(new Date).getFullYear(),r=(0,a.useMemo)(()=>s?Object.keys(s).filter(e=>/^\d{4}$/.test(e)).sort((e,s)=>s-e):[],[s]),[i,l]=(0,a.useState)(n);(0,a.useEffect)(()=>{r.length>0&&!r.includes(i.toString())&&l(parseInt(r[0]))},[r,i]);const o=(0,a.useMemo)(()=>{if(!s||!i)return[];const e=s[i]||{},t={};for(let s=1;s<=12;s++){const n=s.toString().padStart(2,"0");t[n]=e[n]||0}return Object.keys(t).sort((e,s)=>e-s).map(e=>t[e])},[s,i]),c=(0,a.useMemo)(()=>o.reduce((e,s)=>e+s,0),[o]);return s?(0,t.jsxs)(p.PanelBody,{title:"Quiz Analytics",children:[(0,t.jsx)(w,{first24Hours:s.first_24_hours,firstWeek:s.first_week,total:s.total}),r.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.SelectControl,{label:"Select Year",value:i,options:r.map(e=>({label:e,value:parseInt(e)})),onChange:l}),(0,t.jsx)(p.BaseControl,{id:"quiz-analytics-monthly",help:`Monthly Total: ${c}`,children:(0,t.jsx)(m,{values:o})})]})]}):(0,t.jsx)(p.PanelBody,{title:"Quiz Analytics",children:(0,t.jsx)("p",{children:"Loading analytics data..."})})}const x="prc-quiz-builder-analytics-panel";(0,o.registerPlugin)(x,{render:function(){const{postType:e,postId:s}=(0,d.useSelect)(e=>({postType:e(c.store).getCurrentPostType(),postId:e(c.store).getCurrentPostId()}),[]);return"quiz"!==e?null:(0,t.jsxs)(l.Fragment,{children:[(0,t.jsx)(c.PluginSidebarMoreMenuItem,{target:x,icon:n,children:(0,i.__)("Quiz Analytics")}),(0,t.jsx)(c.PluginSidebar,{name:x,title:"Quiz Analytics",icon:(0,t.jsx)(r,{icon:n,size:16}),children:(0,t.jsx)(j,{postId:s})})]})}})})();